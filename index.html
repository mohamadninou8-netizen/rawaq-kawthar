<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø±ÙˆØ§Ù‚ ÙƒÙˆØ«Ø± | HK Book Land</title>
    <link rel="apple-touch-icon" href="https://via.placeholder.com/180/0EA5E9/FFFFFF?text=HK">
<meta name="apple-mobile-web-app-title" content="Ø±ÙˆØ§Ù‚ ÙƒÙˆØ«Ø±">
<meta name="mobile-web-app-capable" content="yes">
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Amiri:wght@400;700&family=Cairo:wght@400;600;700&display=swap');
        :root { --sky: #0EA5E9; --bg: #F8FAFC; --text: #1E293B; --card: #ffffff; }
        .dark-mode { --bg: #0F172A; --text: #F1F5F9; --card: #1E293B; }
        body { font-family: 'Cairo', sans-serif; background-color: var(--bg); color: var(--text); transition: 0.3s; scroll-behavior: smooth; }
        .font-amiri { font-family: 'Amiri', serif; }
        .glass { background: var(--card); border: 1px solid rgba(14, 165, 233, 0.1); backdrop-filter: blur(10px); }
        .book-card { transition: 0.3s; border-radius: 2rem; }
        .book-card:hover { transform: translateY(-10px); shadow: 0 10px 20px rgba(0,0,0,0.1); }
        .modal { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.8); z-index: 100; backdrop-filter: blur(8px); overflow-y: auto; }
        .active-tab { background-color: var(--sky) !important; color: white !important; opacity: 1 !important; }
        @media print { .no-print { display: none !important; } #thermal-area { display: block !important; width: 80mm; color: black; background: white; } }
    </style>
</head>
<body>

    <nav class="no-print sticky top-0 z-50 glass px-4 py-3 border-b border-sky-100 dark:border-sky-900">
        <div class="max-w-6xl mx-auto flex justify-between items-center">
            <div class="flex items-center gap-2">
                <div class="w-10 h-10 bg-sky-500 rounded-full flex items-center justify-center text-white font-bold">HK</div>
                <h1 class="font-amiri text-xl font-bold text-sky-600">Ø±ÙˆØ§Ù‚ ÙƒÙˆØ«Ø±</h1>
            </div>
            <div class="flex items-center gap-2">
                <button onclick="toggleDarkMode()" class="p-2 text-sky-500"><i class="fas fa-adjust text-xl"></i></button>
                <div class="flex bg-gray-100 dark:bg-slate-800 p-1 rounded-2xl scale-90 md:scale-100">
                    <button onclick="switchTab('shop')" id="btn-shop" class="active-tab px-4 py-2 rounded-xl text-xs font-bold transition">Ø§Ù„Ù…ØªØ¬Ø±</button>
                    <button onclick="switchTab('track')" id="btn-track" class="px-4 py-2 text-xs font-bold opacity-60 transition">ØªØªØ¨Ø¹</button>
                    <button onclick="protectedTab('admin')" id="btn-admin" class="px-4 py-2 text-xs font-bold opacity-60 transition">Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©</button>
                </div>
            </div>
        </div>
    </nav>

    <main class="max-w-6xl mx-auto p-4">
        
        <section id="sec-shop" class="space-y-10 py-6">
            <div class="text-center space-y-3">
                <h2 class="font-amiri text-5xl text-sky-500 italic">Ø±ÙˆØ§Ù‚ ÙƒÙˆØ«Ø±</h2>
                <p class="opacity-70">Ø¨ÙŠÙ† Ø§Ù„Ø±ÙÙˆÙ.. Ø­ÙƒØ§ÙŠØ§ ØªÙ†ØªØ¸Ø± Ù…Ù† ÙŠÙ‚Ø±Ø¤Ù‡Ø§</p>
            </div>
            <div id="books-gallery" class="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-5 gap-6"></div>
        </section>

        <section id="sec-track" class="hidden py-10">
            <div class="max-w-md mx-auto glass p-8 rounded-[2.5rem] shadow-2xl text-center">
                <h3 class="font-amiri text-3xl text-sky-500 mb-6">Ø£ÙŠÙ† ÙˆØµÙ„ ÙƒØªØ§Ø¨ÙŠØŸ</h3>
                <div class="flex gap-2 mb-6">
                    <input type="text" id="trackInput" placeholder="Ø£Ø¯Ø®Ù„ Ø±Ù‚Ù… Ø§Ù„Ø·Ù„Ø¨ (HK-XXXX)" class="flex-1 p-4 rounded-2xl border outline-none dark:bg-slate-700">
                    <button onclick="trackOrder()" class="bg-sky-500 text-white px-6 rounded-2xl"><i class="fas fa-search"></i></button>
                </div>
                <div id="trackResult" class="hidden space-y-4">
                    <div class="w-20 h-20 bg-sky-100 rounded-full flex items-center justify-center mx-auto text-sky-500 text-3xl animate-bounce">
                        <i class="fas fa-truck-loading"></i>
                    </div>
                    <p class="font-bold text-lg text-sky-600">Ø·Ù„Ø¨Ùƒ Ù‚ÙŠØ¯ Ø§Ù„ØªØ¬Ù‡ÙŠØ² Ø¨Ø¹Ù†Ø§ÙŠØ© âœ¨</p>
                    <p id="trackBookName" class="text-sm font-bold"></p>
                    <div class="p-4 bg-sky-50 dark:bg-slate-800 rounded-2xl italic text-xs opacity-80" id="trackQuote"></div>
                </div>
            </div>
        </section>

        <section id="sec-admin" class="hidden space-y-6 py-6">
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                <div class="glass p-6 rounded-3xl border-b-4 border-green-500 text-center">
                    <h4 class="text-xs font-bold opacity-60">Ø§Ù„Ø£Ø±Ø¨Ø§Ø­</h4>
                    <p id="total-revenue" class="text-xl font-bold text-green-500">0 Ø¯Ø¬</p>
                </div>
                <div class="glass p-6 rounded-3xl border-b-4 border-sky-500 text-center">
                    <h4 class="text-xs font-bold opacity-60">Ø£ÙØ¶Ù„ ÙˆÙ„Ø§ÙŠØ©</h4>
                    <p id="top-wilaya" class="text-xl font-bold text-sky-500">---</p>
                </div>
            </div>
            <div class="glass p-8 rounded-[2rem]">
                <h3 class="font-bold mb-4 italic">Ø¥Ø¶Ø§ÙØ© ÙƒØªØ§Ø¨ Ø¬Ø¯ÙŠØ¯</h3>
                <form id="addBookForm" class="grid grid-cols-1 md:grid-cols-3 gap-4">
                    <input type="text" id="bTitle" placeholder="Ø§Ø³Ù… Ø§Ù„ÙƒØªØ§Ø¨" class="p-4 border rounded-2xl outline-none dark:bg-slate-700" required>
                    <input type="number" id="bPrice" placeholder="Ø§Ù„Ø³Ø¹Ø±" class="p-4 border rounded-2xl outline-none dark:bg-slate-700" required>
                    <div class="flex gap-2">
                        <button type="button" onclick="document.getElementById('bFile').click()" class="flex-1 border-2 border-dashed rounded-2xl text-sky-500 font-bold">ØµÙˆØ±Ø©</button>
                        <input type="file" id="bFile" class="hidden" accept="image/*" onchange="handleFile(this)">
                        <button type="submit" class="flex-1 bg-sky-500 text-white rounded-2xl font-bold">Ø­ÙØ¸</button>
                    </div>
                </form>
            </div>
            <div id="admin-orders-list" class="space-y-3"></div>
        </section>

    </main>

    <div id="orderModal" class="modal no-print flex items-center justify-center p-4">
        <div class="bg-white dark:bg-slate-800 w-full max-w-md rounded-[2.5rem] overflow-hidden shadow-2xl">
            <div class="p-6 bg-sky-500 text-white text-center">
                <img id="mBookImg" src="" class="h-40 mx-auto rounded-2xl shadow-xl mb-4 object-cover">
                <h2 id="mBookTitle" class="text-2xl font-amiri font-bold"></h2>
                <p id="mBookPrice" class="font-bold opacity-90"></p>
            </div>
            <form id="orderForm" class="p-8 space-y-4">
                <input type="hidden" id="selectedBookIdx">
                <input type="text" id="cName" placeholder="Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„" class="w-full p-4 border rounded-2xl outline-none dark:bg-slate-700" required>
                <div class="grid grid-cols-2 gap-2">
                    <input type="tel" id="cPhone" placeholder="Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ" class="w-full p-4 border rounded-2xl outline-none dark:bg-slate-700" required>
                    <select id="cWilaya" class="w-full p-4 border rounded-2xl outline-none dark:bg-slate-700"></select>
                </div>
                <button type="submit" class="w-full bg-green-500 text-white py-4 rounded-2xl font-bold text-lg flex items-center justify-center gap-2 shadow-lg hover:bg-green-600 transition">
                    <i class="fab fa-whatsapp"></i> ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø·Ù„Ø¨ (ÙˆØ§ØªØ³Ø§Ø¨)
                </button>
                <button type="button" onclick="closeModal()" class="w-full text-xs opacity-50">Ø¥Ù„ØºØ§Ø¡</button>
            </form>
        </div>
    </div>

    <div id="thermal-area" class="hidden"></div>

    <script>
        const KAWTHAR_WA = "213669837391";
        const PIN = "1234";
        const quotes = [
            "Ø§Ù„ÙƒØªØ§Ø¨ Ù‡Ùˆ Ø§Ù„Ø¬Ù„ÙŠØ³ Ø§Ù„Ø°ÙŠ Ù„Ø§ ÙŠØ·Ø±ÙŠÙƒØŒ ÙˆØ§Ù„ØµØ¯ÙŠÙ‚ Ø§Ù„Ø°ÙŠ Ù„Ø§ ÙŠØºØ±ÙŠÙƒ.", "Ø§Ù„Ø¨ÙŠØª Ø¨Ù„Ø§ ÙƒØªØ¨.. Ø¬Ø³Ø¯ Ø¨Ù„Ø§ Ø±ÙˆØ­.", "Ø§Ù„Ù‚Ø±Ø§Ø¡Ø© Ù‡ÙŠ ØªØ°ÙƒØ±Ø© Ø³ÙØ± Ù„Ø¹Ø¯Ø© Ø­ÙŠÙˆØ§Øª.", "Ù…Ù† ÙŠÙ‚Ø±Ø£ ÙŠØ¹Ø´ Ø£Ù„Ù Ø¹Ø§Ù….",
            "Ù„ÙŠØ³ Ù‡Ù†Ø§Ùƒ ØµØ¯ÙŠÙ‚ Ø£ÙˆÙÙ‰ Ù…Ù† Ø§Ù„ÙƒØªØ§Ø¨.", "Ø§Ù„Ù‚Ø±Ø§Ø¡Ø© Ù‡ÙŠ Ø§Ù„Ø¹Ø¶Ù„Ø§Øª Ø§Ù„ØªÙŠ ØªØ¨Ù†ÙŠ Ø¨Ù‡Ø§ Ø¹Ù‚Ù„Ùƒ.", "ØªÙØ§Ø¡Ù„ Ø¨Ù…Ø§ ØªÙ‡ÙˆÙ‰.. ÙŠÙƒÙ†.", "Ù…Ø§ ØªÙ‚Ø±Ø¤Ù‡ Ø§Ù„ÙŠÙˆÙ…ØŒ Ø³ÙŠØ­Ø¯Ø¯ Ù…Ù† Ø³ØªÙƒÙˆÙ† ØºØ¯Ø§Ù‹.",
            "Ø§Ù„Ù†Ø¬Ø§Ø­ Ù„ÙŠØ³ Ù…ÙØªØ§Ø­ Ø§Ù„Ø³Ø¹Ø§Ø¯Ø©ØŒ Ø¨Ù„ Ø§Ù„Ø³Ø¹Ø§Ø¯Ø© Ù‡ÙŠ Ù…ÙØªØ§Ø­ Ø§Ù„Ù†Ø¬Ø§Ø­.", "Ø§Ù„Ø¬Ù…Ø§Ù„ Ù„ÙŠØ³ ÙÙŠ Ø§Ù„Ø£Ø´ÙŠØ§Ø¡ØŒ Ø¨Ù„ ÙÙŠ Ø§Ù„Ø¹Ù‚Ù„ Ø§Ù„Ø°ÙŠ ÙŠØ¯Ø±ÙƒÙ‡Ø§.", "Ø§Ù„Ø³Ø± ÙÙŠ Ø§Ù„Ø­ÙŠØ§Ø© Ù‡Ùˆ Ø£Ù„Ø§ ØªØ¹ØªØ§Ø¯ Ø¹Ù„Ù‰ Ø´ÙŠØ¡.",
            "ÙƒÙ„ ÙŠÙˆÙ… Ù‡Ùˆ ØµÙØ­Ø© Ø¬Ø¯ÙŠØ¯Ø© ÙÙŠ ÙƒØªØ§Ø¨ Ø­ÙŠØ§ØªÙƒ.", "Ø§Ù„Ù‚Ø±Ø§Ø¡Ø© Ù‡ÙŠ Ø§Ù„ØªÙ†ÙØ³ Ø§Ù„ÙÙƒØ±ÙŠ Ù„Ù„Ø¥Ù†Ø³Ø§Ù†.", "Ø®ØªØ§Ù… ÙƒÙ„ ÙƒØªØ§Ø¨ Ù‡Ùˆ Ø¨Ø¯Ø§ÙŠØ© Ù„ÙÙƒØ±Ø© Ø¬Ø¯ÙŠØ¯Ø©.", "Ø§ØµÙ†Ø¹ Ù…Ù† Ø­Ø·Ø§Ù…Ùƒ Ø­ÙŠØ§Ø©.",
            "Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ø°ÙŠ ØªØ³ØªÙ…ØªØ¹ Ø¨Ø¥Ø¶Ø§Ø¹ØªÙ‡ Ù„ÙŠØ³ ÙˆÙ‚ØªØ§Ù‹ Ø¶Ø§Ø¦Ø¹Ø§Ù‹.", "Ø§Ù„ÙƒÙ„Ù…Ø© Ø§Ù„Ø·ÙŠØ¨Ø© ÙƒØ§Ù„Ø´Ø¬Ø±Ø© Ø§Ù„Ø·ÙŠØ¨Ø©.", "Ø§Ù„ÙƒØªØ¨ ØªÙØªØ­ Ù†ÙˆØ§ÙØ° Ø§Ù„Ø±ÙˆØ­.", "Ø§Ù„Ø¹Ù„Ù… ØµÙŠØ¯ØŒ ÙˆØ§Ù„ÙƒØªØ§Ø¨Ø© Ù‚ÙŠØ¯.",
            "ÙƒÙ† Ø£Ù†Øª Ø§Ù„ØªØºÙŠÙŠØ± Ø§Ù„Ø°ÙŠ ØªØ±ÙŠØ¯ Ø£Ù† ØªØ±Ø§Ù‡.", "Ù„Ø§ ÙŠÙ‡Ù… ÙƒÙ… Ù…Ù† Ø§Ù„ÙƒØªØ¨ ØªÙ‚Ø±Ø£ØŒ Ø§Ù„Ù…Ù‡Ù… Ù…Ø§Ø°Ø§ ØªØªØ±Ùƒ Ø§Ù„ÙƒØªØ¨ ÙÙŠÙƒ.", "Ø§Ù„ÙƒØªØ¨ Ù‡ÙŠ Ø§Ù„Ø¢Ø«Ø§Ø± Ø§Ù„Ø£ÙƒØ«Ø± Ø¨Ù‚Ø§Ø¡Ù‹ Ù„Ù„Ø±ÙˆØ­.",
            "Ø§Ù‚Ø±Ø£ Ù„ØªØ¹ÙŠØ´ØŒ Ù„Ø§ Ù„ØªØ¹Ø±Ù ÙÙ‚Ø·.", "Ø§Ù„Ø­ÙƒÙŠÙ… Ù‡Ùˆ Ù…Ù† ÙŠØ¹Ø±Ù Ø£Ù†Ù‡ Ù„Ø§ ÙŠØ¹Ø±Ù Ø§Ù„ÙƒØ«ÙŠØ±.", "Ø¹Ù‚Ù„ Ø§Ù„Ù…ØªØ¹Ù„Ù… Ù‡Ùˆ Ù‚ØµØ± Ù„Ø§ ÙŠØ³ÙƒÙ†Ù‡ Ø§Ù„Ø¸Ù„Ø§Ù….", "Ø§Ù„ØµØ¨Ø± Ù…Ø±Ù‘ØŒ Ù„ÙƒÙ† Ø«Ù…Ø±ØªÙ‡ Ø­Ù„ÙˆØ©.",
            "ÙƒÙ† ØµØ¨ÙˆØ±Ø§Ù‹ØŒ ÙØ§Ù„Ø£Ø´ÙŠØ§Ø¡ Ø§Ù„Ø¬Ù…ÙŠÙ„Ø© ØªØ­ØªØ§Ø¬ ÙˆÙ‚ØªØ§Ù‹.", "Ø§Ù„Ø­ÙŠØ§Ø© Ø±ÙˆØ§ÙŠØ© ØªØ³ØªØ­Ù‚ Ø§Ù„Ù‚Ø±Ø§Ø¡Ø©.", "ÙƒÙ„ ÙƒØªØ§Ø¨ ØªÙ‚Ø±Ø¤Ù‡ Ù‡Ùˆ Ø­ÙŠØ§Ø© Ø¬Ø¯ÙŠØ¯Ø©.", "Ø±ÙˆØ§Ù‚ ÙƒÙˆØ«Ø± ÙŠØªÙ…Ù†Ù‰ Ù„Ùƒ Ù‚Ø±Ø§Ø¡Ø© Ù…Ù…ØªØ¹Ø©."
        ];

        const wilayas = ["01 Ø£Ø¯Ø±Ø§Ø±", "02 Ø§Ù„Ø´Ù„Ù", "03 Ø§Ù„Ø£ØºÙˆØ§Ø·", "04 Ø£Ù… Ø§Ù„Ø¨ÙˆØ§Ù‚ÙŠ", "05 Ø¨Ø§ØªÙ†Ø©", "06 Ø¨Ø¬Ø§ÙŠØ©", "07 Ø¨Ø³ÙƒØ±Ø©", "08 Ø¨Ø´Ø§Ø±", "09 Ø§Ù„Ø¨Ù„ÙŠØ¯Ø©", "10 Ø§Ù„Ø¨ÙˆÙŠØ±Ø©", "11 ØªÙ…Ù†Ø±Ø§Ø³Øª", "12 ØªØ¨Ø³Ø©", "13 ØªÙ„Ù…Ø³Ø§Ù†", "14 ØªÙŠØ§Ø±Øª", "15 ØªÙŠØ²ÙŠ ÙˆØ²Ùˆ", "16 Ø§Ù„Ø¬Ø²Ø§Ø¦Ø±", "17 Ø§Ù„Ø¬Ù„ÙØ©", "18 Ø¬ÙŠØ¬Ù„", "19 Ø³Ø·ÙŠÙ", "20 Ø³Ø¹ÙŠØ¯Ø©", "21 Ø³ÙƒÙŠÙƒØ¯Ø©", "22 Ø³ÙŠØ¯ÙŠ Ø¨Ù„Ø¹Ø¨Ø§Ø³", "23 Ø¹Ù†Ø§Ø¨Ø©", "24 Ù‚Ø§Ù„Ù…Ø©", "25 Ù‚Ø³Ù†Ø·ÙŠÙ†Ø©", "26 Ø§Ù„Ù…Ø¯ÙŠØ©", "27 Ù…Ø³ØªØºØ§Ù†Ù…", "28 Ø§Ù„Ù…Ø³ÙŠÙ„Ø©", "29 Ù…Ø¹Ø³ÙƒØ±", "30 ÙˆØ±Ù‚Ù„Ø©", "31 ÙˆÙ‡Ø±Ø§Ù†", "32 Ø§Ù„Ø¨ÙŠØ¶", "33 Ø¥Ù„ÙŠØ²ÙŠ", "34 Ø¨Ø±Ø¬ Ø¨ÙˆØ¹Ø±ÙŠØ±ÙŠØ¬", "35 Ø¨ÙˆÙ…Ø±Ø¯Ø§Ø³", "36 Ø§Ù„Ø·Ø§Ø±Ù", "37 ØªÙ†Ø¯ÙˆÙ", "38 ØªØ³Ù…Ø³ÙŠÙ„Øª", "39 Ø§Ù„ÙˆØ§Ø¯ÙŠ", "40 Ø®Ù†Ø´Ù„Ø©", "41 Ø³ÙˆÙ‚ Ø£Ù‡Ø±Ø§Ø³", "42 ØªÙŠØ¨Ø§Ø²Ø©", "43 Ù…ÙŠÙ„Ø©", "44 Ø¹ÙŠÙ† Ø§Ù„Ø¯ÙÙ„Ù‰", "45 Ø§Ù„Ù†Ø¹Ø§Ù…Ø©", "46 Ø¹ÙŠÙ† ØªÙ…ÙˆØ´Ù†Øª", "47 ØºØ±Ø¯Ø§ÙŠØ©", "48 ØºÙ„ÙŠØ²Ø§Ù†", "49 ØªÙŠÙ…ÙŠÙ…ÙˆÙ†", "50 Ø¨Ø±Ø¬ Ø¨Ø§Ø¬ÙŠ Ù…Ø®ØªØ§Ø±", "51 Ø£ÙˆÙ„Ø§Ø¯ Ø¬Ù„Ø§Ù„", "52 Ø¨Ù†ÙŠ Ø¹Ø¨Ø§Ø³", "53 Ø¹ÙŠÙ† ØµØ§Ù„Ø­", "54 Ø¹ÙŠÙ† Ù‚Ø²Ø§Ù…", "55 ØªÙ‚Ø±Øª", "56 Ø¬Ø§Ù†Øª", "57 Ø§Ù„Ù…ØºÙŠØ±", "58 Ø§Ù„Ù…Ù†ÙŠØ¹Ø©"];

        let inventory = JSON.parse(localStorage.getItem('HK_INV_FINAL')) || [];
        let orders = JSON.parse(localStorage.getItem('HK_ORD_FINAL')) || [];
        let tempImg = "";

        document.getElementById('cWilaya').innerHTML = wilayas.map(w => `<option value="${w}">${w}</option>`).join('');

        function switchTab(t) {
            ['shop', 'track', 'admin'].forEach(s => {
                document.getElementById('sec-'+s).classList.add('hidden');
                document.getElementById('btn-'+s).classList.remove('active-tab');
                document.getElementById('btn-'+s).classList.add('opacity-60');
            });
            document.getElementById('sec-'+t).classList.remove('hidden');
            document.getElementById('btn-'+t).classList.add('active-tab');
            document.getElementById('btn-'+t).classList.remove('opacity-60');
            updateUI();
        }

        function protectedTab(t) { if(prompt("Ø±Ù…Ø² Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©:") === PIN) switchTab(t); }

        function toggleDarkMode() { document.body.classList.toggle('dark-mode'); }

        function handleFile(input) {
            const reader = new FileReader();
            reader.onload = e => tempImg = e.target.result;
            reader.readAsDataURL(input.files[0]);
        }

        document.getElementById('addBookForm').onsubmit = e => {
            e.preventDefault();
            if(!tempImg) return alert("Ø§Ø®ØªØ± ØµÙˆØ±Ø©!");
            inventory.push({ id: Date.now(), title: document.getElementById('bTitle').value, price: document.getElementById('bPrice').value, img: tempImg });
            localStorage.setItem('HK_INV_FINAL', JSON.stringify(inventory));
            e.target.reset(); tempImg = ""; updateUI();
        };

        function updateUI() {
            document.getElementById('books-gallery').innerHTML = inventory.map((b, idx) => `
                <div class="glass p-4 rounded-3xl book-card text-center shadow-sm" onclick="openOrderModal(${idx})">
                    <img src="${b.img}" class="h-44 w-full object-cover rounded-2xl mb-3 shadow">
                    <h3 class="font-bold text-xs truncate px-1">${b.title}</h3>
                    <p class="text-sky-500 font-bold">${b.price} Ø¯Ø¬</p>
                </div>
            `).join('');

            if(orders.length > 0) {
                document.getElementById('total-revenue').innerText = orders.reduce((s,o) => s+Number(o.price), 0) + " Ø¯Ø¬";
                const wMap = {}; orders.forEach(o => wMap[o.wilaya] = (wMap[o.wilaya] || 0) + 1);
                document.getElementById('top-wilaya').innerText = Object.keys(wMap).reduce((a,b) => wMap[a] > wMap[b] ? a : b).split(' ')[1];
            }

            document.getElementById('admin-orders-list').innerHTML = orders.map(o => `
                <div class="glass p-4 rounded-2xl flex justify-between items-center border-r-4 border-sky-500 shadow-sm">
                    <div class="flex items-center gap-3">
                        <img src="${o.img}" class="w-10 h-10 rounded-full object-cover">
                        <div><p class="font-bold text-sm">${o.name} <span class="text-[9px] opacity-40">#${o.oid}</span></p>
                        <p class="text-[10px] opacity-60">${o.book} - ${o.wilaya}</p></div>
                    </div>
                    <div class="flex gap-2">
                        <button onclick="printBill('${o.oid}')" class="text-sky-500 p-2"><i class="fas fa-print"></i></button>
                        <button onclick="delOrder('${o.oid}')" class="text-red-400 p-2"><i class="fas fa-trash"></i></button>
                    </div>
                </div>
            `).join('');
        }

        function trackOrder() {
            const id = document.getElementById('trackInput').value.toUpperCase();
            const o = orders.find(x => x.oid === id);
            const res = document.getElementById('trackResult');
            if(o) {
                res.classList.remove('hidden');
                document.getElementById('trackBookName').innerText = `ÙƒØªØ§Ø¨Ùƒ: ${o.book}`;
                document.getElementById('trackQuote').innerText = `"${o.quote}"`;
            } else alert("Ø§Ù„Ø±Ù‚Ù… ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯ ÙÙŠ Ø³Ø¬Ù„Ø§ØªÙ†Ø§");
        }

        function openOrderModal(idx) {
            const b = inventory[idx];
            document.getElementById('selectedBookIdx').value = idx;
            document.getElementById('mBookImg').src = b.img;
            document.getElementById('mBookTitle').innerText = b.title;
            document.getElementById('mBookPrice').innerText = b.price + " Ø¯Ø¬";
            document.getElementById('orderModal').style.display = 'flex';
        }

        function closeModal() { document.getElementById('orderModal').style.display = 'none'; }

        document.getElementById('orderForm').onsubmit = e => {
            e.preventDefault();
            const b = inventory[document.getElementById('selectedBookIdx').value];
            const oid = 'HK-' + Math.floor(1000 + Math.random()*8999);
            const quote = quotes[Math.floor(Math.random()*quotes.length)];

            orders.unshift({ oid, name: document.getElementById('cName').value, phone: document.getElementById('cPhone').value, wilaya: document.getElementById('cWilaya').value, book: b.title, price: b.price, img: b.img, quote, date: new Date().toLocaleDateString('ar-DZ') });
            localStorage.setItem('HK_ORD_FINAL', JSON.stringify(orders));

            const msg = `*Ø·Ù„Ø¨ Ø¬Ø¯ÙŠØ¯ Ù…Ù† Ø±ÙˆØ§Ù‚ ÙƒÙˆØ«Ø±* ğŸ“š%0A*Ø±Ù‚Ù… Ø§Ù„Ø·Ù„Ø¨:* ${oid}%0A*Ø§Ù„Ø²Ø¨ÙˆÙ†:* ${document.getElementById('cName').value}%0A*Ø§Ù„ÙƒØªØ§Ø¨:* ${b.title}%0A%0A_Ø­ÙƒÙ…Ø© Ø§Ù„ÙŠÙˆÙ…: ${quote}_`;
            window.open(`https://wa.me/${KAWTHAR_WA}?text=${msg}`, '_blank');
            closeModal(); updateUI();
        };

        function printBill(id) {
            const o = orders.find(x => x.oid === id);
            const area = document.getElementById('thermal-area');
            area.innerHTML = `
                <div style="width: 75mm; padding: 5mm; text-align: center; color: black; font-family: 'Cairo';">
                    <div style="border: 2px solid black; border-radius: 50%; width: 20mm; height: 20mm; margin: 0 auto; line-height: 20mm; font-size: 20px;"><b>HK</b></div>
                    <h2 style="margin: 5px 0;">Ø±ÙˆØ§Ù‚ ÙƒÙˆØ«Ø±</h2>
                    <p style="font-size: 10px;">${o.oid} | ${o.date}</p>
                    <hr style="border: 0.5px dashed black; margin: 10px 0;">
                    <div style="text-align: right; font-size: 12px; line-height: 1.6;">
                        <p><b>Ø§Ù„Ø²Ø¨ÙˆÙ†:</b> ${o.name}</p>
                        <p><b>Ø§Ù„ÙˆÙ„Ø§ÙŠØ©:</b> ${o.wilaya}</p>
                        <p><b>Ø§Ù„ÙƒØªØ§Ø¨:</b> ${o.book}</p>
                        <p style="font-size: 14px;"><b>Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹: ${o.price} DA</b></p>
                    </div>
                    <hr style="border: 0.5px dashed black; margin: 10px 0;">
                    <p style="font-size: 10px; font-style: italic;">"${o.quote}"</p>
                </div>`;
            window.print();
        }

        function delOrder(id) { if(confirm('Ø­Ø°ÙØŸ')) { orders = orders.filter(x => x.oid !== id); localStorage.setItem('HK_ORD_FINAL', JSON.stringify(orders)); updateUI(); } }

        updateUI();
    </script>
</body>
</html>
