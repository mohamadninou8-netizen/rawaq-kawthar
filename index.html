<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø±ÙˆØ§Ù‚ ÙƒÙˆØ«Ø± |HK Book Land</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Amiri:wght@400;700&family=Cairo:wght@400;600;700&display=swap');
        :root { --sky: #0EA5E9; --bg: #F8FAFC; --text: #1E293B; --card: #ffffff; }
        .dark-mode { --bg: #0F172A; --text: #F1F5F9; --card: #1E293B; }
        body { font-family: 'Cairo', sans-serif; background-color: var(--bg); color: var(--text); transition: 0.3s; margin:0; }
        .font-amiri { font-family: 'Amiri', serif; }
        .glass { background: var(--card); border: 1px solid rgba(14, 165, 233, 0.1); backdrop-filter: blur(10px); }
        .modal { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.8); z-index: 100; backdrop-filter: blur(8px); align-items: center; justify-content: center; }
        .active-tab { background-color: var(--sky) !important; color: white !important; opacity: 1 !important; }
        @media print { .no-print { display: none !important; } #thermal-area { display: block !important; width: 80mm; color: black; background: white; padding: 10px; direction: rtl; } }
    </style>
</head>
<body>

    <nav class="no-print sticky top-0 z-50 glass px-4 py-3 border-b shadow-sm">
        <div class="max-w-6xl mx-auto flex justify-between items-center">
            <div class="flex items-center gap-2">
                <div class="w-10 h-10 bg-sky-500 rounded-full flex items-center justify-center text-white font-bold shadow-lg">HK</div>
                <h1 class="font-amiri text-xl font-bold text-sky-600">Ø±ÙˆØ§Ù‚ ÙƒÙˆØ«Ø±</h1>
            </div>
            <div class="flex items-center gap-2">
                <button onclick="toggleDarkMode()" class="p-2 text-sky-500"><i class="fas fa-adjust text-xl"></i></button>
                <div class="flex bg-gray-100 dark:bg-slate-800 p-1 rounded-2xl scale-90 md:scale-100 shadow-inner">
                    <button onclick="switchTab('shop')" id="btn-shop" class="active-tab px-4 py-2 rounded-xl text-xs font-bold transition">Ø§Ù„Ù…ØªØ¬Ø±</button>
                    <button onclick="switchTab('track')" id="btn-track" class="px-4 py-2 text-xs font-bold opacity-60 transition">ØªØªØ¨Ø¹</button>
                    <button onclick="protectedTab('admin')" id="btn-admin" class="px-4 py-2 text-xs font-bold opacity-60 transition">Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©</button>
                </div>
            </div>
        </div>
    </nav>

    <main class="max-w-6xl mx-auto p-4">
        
        <section id="sec-shop" class="space-y-10 py-6">
            <div class="text-center space-y-3">
                <h2 class="font-amiri text-5xl text-sky-500 italic">Ø±ÙˆØ§Ù‚ ÙƒÙˆØ«Ø±</h2>
                <p class="opacity-70 italic font-semibold">"Ø¨ÙŠÙ† Ø±ÙÙˆÙÙ†Ø§ Ø­ÙƒØ§ÙŠØ© ØªÙ†ØªØ¸Ø± Ù…Ù† ÙŠÙ‚Ø±Ø¤Ù‡Ø§"</p>
            </div>
            <div id="books-gallery" class="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-5 gap-6"></div>
        </section>

        <section id="sec-track" class="hidden py-10">
            <div class="max-w-md mx-auto glass p-8 rounded-[2.5rem] shadow-2xl text-center border-t-4 border-sky-400">
                <h3 class="font-amiri text-3xl text-sky-500 mb-6 font-bold">ØªØªØ¨Ø¹ Ø·Ù„Ø¨Ùƒ</h3>
                <div class="flex gap-2 mb-6">
                    <input type="text" id="trackInput" placeholder="HK-XXXX" class="flex-1 p-4 rounded-2xl border outline-none dark:bg-slate-700 dark:border-slate-600 shadow-sm uppercase">
                    <button onclick="trackOrder()" class="bg-sky-500 text-white px-6 rounded-2xl hover:bg-sky-600 transition"><i class="fas fa-search"></i></button>
                </div>
                <div id="trackResult" class="hidden space-y-4">
                    <div class="w-16 h-16 bg-sky-100 dark:bg-sky-900 rounded-full flex items-center justify-center mx-auto text-sky-500 text-2xl animate-bounce">
                        <i class="fas fa-truck-loading"></i>
                    </div>
                    <p class="font-bold text-sky-600">Ø·Ù„Ø¨Ùƒ Ù‚ÙŠØ¯ Ø§Ù„ØªØ¬Ù‡ÙŠØ² Ø¨Ø¹Ù†Ø§ÙŠØ© âœ¨</p>
                    <div class="p-4 bg-sky-50 dark:bg-slate-800 rounded-2xl italic text-xs border border-sky-100 dark:border-sky-900 leading-relaxed shadow-inner" id="trackQuote"></div>
                </div>
            </div>
        </section>

        <section id="sec-admin" class="hidden space-y-6 py-6">
            <div class="grid grid-cols-2 gap-4">
                <div class="glass p-6 rounded-3xl text-center border-b-4 border-green-500 shadow-sm">
                    <h4 class="text-[10px] font-bold opacity-60">Ø§Ù„Ø£Ø±Ø¨Ø§Ø­</h4>
                    <p id="total-revenue" class="text-2xl font-bold text-green-500">0 Ø¯Ø¬</p>
                </div>
                <div class="glass p-6 rounded-3xl text-center border-b-4 border-sky-500 shadow-sm">
                    <h4 class="text-[10px] font-bold opacity-60">Ø§Ù„Ø·Ù„Ø¨Ø§Øª</h4>
                    <p id="order-count" class="text-2xl font-bold text-sky-500">0</p>
                </div>
            </div>

            <div class="glass p-6 rounded-[2rem] grid grid-cols-2 gap-4 shadow-sm">
                <button onclick="exportData()" class="bg-sky-50 dark:bg-slate-700 p-4 rounded-2xl text-[10px] font-bold hover:bg-sky-500 hover:text-white transition"><i class="fas fa-download ml-2"></i>Ù†Ø³Ø®Ø© Ø§Ø­ØªÙŠØ§Ø·ÙŠØ©</button>
                <button onclick="importData()" class="bg-sky-50 dark:bg-slate-700 p-4 rounded-2xl text-[10px] font-bold hover:bg-sky-500 hover:text-white transition"><i class="fas fa-upload ml-2"></i>Ø§Ø³ØªØ¹Ø§Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</button>
            </div>

            <div class="glass p-8 rounded-[2rem] shadow-sm">
                <h3 class="font-bold mb-4 text-sm">Ø¥Ø¶Ø§ÙØ© ÙƒØªØ§Ø¨ Ø¬Ø¯ÙŠØ¯</h3>
                <form id="addBookForm" class="grid grid-cols-1 md:grid-cols-3 gap-4">
                    <input type="text" id="bTitle" placeholder="Ø§Ø³Ù… Ø§Ù„ÙƒØªØ§Ø¨" class="p-4 border rounded-2xl outline-none dark:bg-slate-700 dark:border-slate-600 text-sm" required>
                    <input type="number" id="bPrice" placeholder="Ø§Ù„Ø³Ø¹Ø±" class="p-4 border rounded-2xl outline-none dark:bg-slate-700 dark:border-slate-600 text-sm" required>
                    <div class="flex gap-2">
                        <button type="button" onclick="document.getElementById('bFile').click()" class="flex-1 border-2 border-dashed border-sky-300 rounded-2xl text-sky-500 font-bold text-xs">ØµÙˆØ±Ø©</button>
                        <input type="file" id="bFile" class="hidden" accept="image/*" onchange="handleFile(this)">
                        <button type="submit" class="flex-1 bg-sky-500 text-white rounded-2xl font-bold shadow-lg">Ø­ÙØ¸</button>
                    </div>
                </form>
            </div>

            <div class="glass p-6 rounded-[2rem] shadow-sm">
                <h3 class="font-bold mb-4 text-sm text-sky-600"><i class="fas fa-trash-alt ml-2"></i>Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø±ÙÙˆÙ (Ø­Ø°Ù Ø§Ù„ÙƒØªØ¨)</h3>
                <div id="admin-inventory-list" class="grid grid-cols-2 md:grid-cols-4 gap-4"></div>
            </div>

            <div id="admin-orders-list" class="space-y-3"></div>
        </section>
    </main>

    <div id="orderModal" class="modal no-print p-4">
        <div class="bg-white dark:bg-slate-800 w-full max-w-md rounded-[2.5rem] overflow-hidden shadow-2xl">
            <div class="p-6 bg-sky-500 text-white text-center">
                <img id="mBookImg" src="" class="h-40 mx-auto rounded-2xl shadow-xl mb-4 object-cover border-4 border-white">
                <h2 id="mBookTitle" class="text-2xl font-amiri font-bold"></h2>
                <p id="mBookPrice" class="font-bold text-lg opacity-90"></p>
            </div>
            <form id="orderForm" class="p-8 space-y-4">
                <input type="hidden" id="selectedBookIdx">
                <input type="text" id="cName" placeholder="Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„" class="w-full p-4 border rounded-2xl outline-none dark:bg-slate-700 dark:border-slate-600" required>
                <div class="grid grid-cols-2 gap-2">
                    <input type="tel" id="cPhone" placeholder="Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ" class="w-full p-4 border rounded-2xl outline-none dark:bg-slate-700 dark:border-slate-600" required>
                    <select id="cWilaya" class="w-full p-4 border rounded-2xl outline-none dark:bg-slate-700 dark:border-slate-600 text-sm"></select>
                </div>
                <button type="submit" class="w-full bg-green-500 text-white py-4 rounded-2xl font-bold shadow-lg flex items-center justify-center gap-2">
                    <i class="fab fa-whatsapp text-xl"></i> Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨ Ø¹Ø¨Ø± ÙˆØ§ØªØ³Ø§Ø¨
                </button>
                <button type="button" onclick="closeModal()" class="w-full text-xs opacity-50">Ø¥Ù„ØºØ§Ø¡</button>
            </form>
        </div>
    </div>

    <div id="thermal-area" class="hidden"></div>

    <script>
        const KAWTHAR_WA = "213669837391";
        const PIN = "kawtar2003";
        const quotes = ["Ø§Ù„ÙƒØªØ§Ø¨ Ø®ÙŠØ± Ø¬Ù„ÙŠØ³ ÙÙŠ Ø§Ù„Ø£Ù†Ø§Ù….", "Ø§Ù‚Ø±Ø£ Ù„ØªØ¹ÙŠØ´ Ù…Ø±ØªÙŠÙ†.. Ø§Ù„Ù‚Ø±Ø§Ø¡Ø© Ø­ÙŠØ§Ø© Ø«Ø§Ù†ÙŠØ©.", "ØªÙØ§Ø¡Ù„ Ø¨Ù…Ø§ ØªÙ‡ÙˆÙ‰.. ÙŠÙƒÙ† Ø¨Ø¥Ø°Ù† Ø§Ù„Ù„Ù‡.", "Ø§Ù„Ø¨ÙŠØª Ø¨Ù„Ø§ ÙƒØªØ¨.. Ø¬Ø³Ø¯ Ø¨Ù„Ø§ Ø±ÙˆØ­.", "Ø§Ù„Ù‚Ø±Ø§Ø¡Ø© Ù†Ø§ÙØ°Ø© ÙŠØ·Ù„ Ù…Ù†Ù‡Ø§ Ø§Ù„Ø¹Ù‚Ù„ Ø¹Ù„Ù‰ Ø§Ù„Ø¹Ø§Ù„Ù… Ø§Ù„Ø¬Ù…ÙŠÙ„.", "Ø§Ù„Ø¹Ù„Ù… ØµÙŠØ¯ ÙˆØ§Ù„ÙƒØªØ§Ø¨Ø© Ù‚ÙŠØ¯Ù‡."];
        const wilayas = ["01 Ø£Ø¯Ø±Ø§Ø±", "02 Ø§Ù„Ø´Ù„Ù", "03 Ø§Ù„Ø£ØºÙˆØ§Ø·", "04 Ø£Ù… Ø§Ù„Ø¨ÙˆØ§Ù‚ÙŠ", "05 Ø¨Ø§ØªÙ†Ø©", "06 Ø¨Ø¬Ø§ÙŠØ©", "07 Ø¨Ø³ÙƒØ±Ø©", "08 Ø¨Ø´Ø§Ø±", "09 Ø§Ù„Ø¨Ù„ÙŠØ¯Ø©", "10 Ø§Ù„Ø¨ÙˆÙŠØ±Ø©", "11 ØªÙ…Ù†Ø±Ø§Ø³Øª", "12 ØªØ¨Ø³Ø©", "13 ØªÙ„Ù…Ø³Ø§Ù†", "14 ØªÙŠØ§Ø±Øª", "15 ØªÙŠØ²ÙŠ ÙˆØ²Ùˆ", "16 Ø§Ù„Ø¬Ø²Ø§Ø¦Ø±", "17 Ø§Ù„Ø¬Ù„ÙØ©", "18 Ø¬ÙŠØ¬Ù„", "19 Ø³Ø·ÙŠÙ", "20 Ø³Ø¹ÙŠØ¯Ø©", "21 Ø³ÙƒÙŠÙƒØ¯Ø©", "22 Ø³ÙŠØ¯ÙŠ Ø¨Ù„Ø¹Ø¨Ø§Ø³", "23 Ø¹Ù†Ø§Ø¨Ø©", "24 Ù‚Ø§Ù„Ù…Ø©", "25 Ù‚Ø³Ù†Ø·ÙŠÙ†Ø©", "26 Ø§Ù„Ù…Ø¯ÙŠØ©", "27 Ù…Ø³ØªØºØ§Ù†Ù…", "28 Ø§Ù„Ù…Ø³ÙŠÙ„Ø©", "29 Ù…Ø¹Ø³ÙƒØ±", "30 ÙˆØ±Ù‚Ù„Ø©", "31 ÙˆÙ‡Ø±Ø§Ù†", "32 Ø§Ù„Ø¨ÙŠØ¶", "33 Ø¥Ù„ÙŠØ²ÙŠ", "34 Ø¨Ø±Ø¬ Ø¨ÙˆØ¹Ø±ÙŠØ±ÙŠØ¬", "35 Ø¨ÙˆÙ…Ø±Ø¯Ø§Ø³", "36 Ø§Ù„Ø·Ø§Ø±Ù", "37 ØªÙ†Ø¯ÙˆÙ", "38 ØªØ³Ù…Ø³ÙŠÙ„Øª", "39 Ø§Ù„ÙˆØ§Ø¯ÙŠ", "40 Ø®Ù†Ø´Ù„Ø©", "41 Ø³ÙˆÙ‚ Ø£Ù‡Ø±Ø§Ø³", "42 ØªÙŠØ¨Ø§Ø²Ø©", "43 Ù…ÙŠÙ„Ø©", "44 Ø¹ÙŠÙ† Ø§Ù„Ø¯ÙÙ„Ù‰", "45 Ø§Ù„Ù†Ø¹Ø§Ù…Ø©", "46 Ø¹ÙŠÙ† ØªÙ…ÙˆØ´Ù†Øª", "47 ØºØ±Ø¯Ø§ÙŠØ©", "48 ØºÙ„ÙŠØ²Ø§Ù†", "49 ØªÙŠÙ…ÙŠÙ…ÙˆÙ†", "50 Ø¨Ø±Ø¬ Ø¨Ø§Ø¬ÙŠ Ù…Ø®ØªØ§Ø±", "51 Ø£ÙˆÙ„Ø§Ø¯ Ø¬Ù„Ø§Ù„", "52 Ø¨Ù†ÙŠ Ø¹Ø¨Ø§Ø³", "53 Ø¹ÙŠÙ† ØµØ§Ù„Ø­", "54 Ø¹ÙŠÙ† Ù‚Ø²Ø§Ù…", "55 ØªÙ‚Ø±Øª", "56 Ø¬Ø§Ù†Øª", "57 Ø§Ù„Ù…ØºÙŠØ±", "58 Ø§Ù„Ù…Ù†ÙŠØ¹Ø©"];

        let inventory = JSON.parse(localStorage.getItem('HK_INV')) || [];
        let orders = JSON.parse(localStorage.getItem('HK_ORD')) || [];
        let tempImg = "";

        document.getElementById('cWilaya').innerHTML = wilayas.map(w => `<option value="${w}">${w}</option>`).join('');

        function switchTab(t) {
            ['shop', 'track', 'admin'].forEach(s => {
                document.getElementById('sec-'+s).classList.add('hidden');
                document.getElementById('btn-'+s).classList.remove('active-tab');
            });
            document.getElementById('sec-'+t).classList.remove('hidden');
            document.getElementById('btn-'+t).classList.add('active-tab');
            updateUI();
        }

        function protectedTab(t) { if(prompt("Ø±Ù…Ø² Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©:") === PIN) switchTab(t); }

        function handleFile(input) {
            const reader = new FileReader();
            reader.onload = e => tempImg = e.target.result;
            reader.readAsDataURL(input.files[0]);
        }

        document.getElementById('addBookForm').onsubmit = e => {
            e.preventDefault();
            if(!tempImg) return alert("Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø±ÙØ§Ù‚ ØµÙˆØ±Ø©");
            inventory.push({ id: Date.now(), title: document.getElementById('bTitle').value, price: document.getElementById('bPrice').value, img: tempImg });
            localStorage.setItem('HK_INV', JSON.stringify(inventory));
            e.target.reset(); tempImg = ""; updateUI();
        };

        function updateUI() {
            const gallery = document.getElementById('books-gallery');
            const adminInv = document.getElementById('admin-inventory-list');
            
            if (inventory.length === 0) {
                gallery.className = "col-span-full py-20 text-center";
                gallery.innerHTML = `<div class="w-16 h-16 bg-sky-100 rounded-full flex items-center justify-center text-sky-500 text-2xl mx-auto mb-4 animate-pulse"><i class="fas fa-book-open"></i></div><h3 class="font-amiri text-2xl font-bold text-sky-600">Ø£Ù‡Ù„Ø§Ù‹ Ø¨ÙƒÙ ÙÙŠ Ø±ÙˆØ§Ù‚ÙƒÙ ÙŠØ§ ÙƒÙˆØ«Ø±!</h3><p class="opacity-70 text-sm">Ø£Ø¶ÙŠÙÙŠ ÙƒØªØ¨ÙƒÙ Ù…Ù† Ù‚Ø³Ù… Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©.</p>`;
                adminInv.innerHTML = `<p class="col-span-full text-center text-xs opacity-40">Ø§Ù„Ù…ØªØ¬Ø± ÙØ§Ø±Øº</p>`;
            } else {
                gallery.className = "grid grid-cols-2 md:grid-cols-4 lg:grid-cols-5 gap-6";
                gallery.innerHTML = inventory.map((b, idx) => `
                    <div class="glass p-4 rounded-3xl text-center shadow-sm hover:scale-105 transition cursor-pointer" onclick="openOrderModal(${idx})">
                        <img src="${b.img}" class="h-44 w-full object-cover rounded-2xl mb-3 shadow-sm">
                        <h3 class="font-bold text-[11px] truncate">${b.title}</h3>
                        <p class="text-sky-500 font-bold text-sm">${b.price} Ø¯Ø¬</p>
                    </div>`).join('');
                
                adminInv.innerHTML = inventory.map((b, idx) => `
                    <div class="relative bg-gray-50 dark:bg-slate-700 p-2 rounded-2xl border dark:border-slate-600">
                        <img src="${b.img}" class="h-16 w-full object-cover rounded-xl mb-1">
                        <p class="text-[9px] font-bold truncate">${b.title}</p>
                        <button onclick="delBook(${idx})" class="absolute -top-1 -left-1 bg-red-500 text-white w-6 h-6 rounded-full text-[10px] shadow-lg"><i class="fas fa-times"></i></button>
                    </div>`).join('');
            }

            document.getElementById('total-revenue').innerText = orders.reduce((s,o) => s+Number(o.price), 0) + " Ø¯Ø¬";
            document.getElementById('order-count').innerText = orders.length;

            document.getElementById('admin-orders-list').innerHTML = orders.map(o => `
                <div class="glass p-4 rounded-2xl flex justify-between items-center border-r-4 border-sky-500 shadow-sm mb-3">
                    <div><p class="font-bold text-sm">${o.name}</p><p class="text-[10px] opacity-60">${o.book} | ${o.wilaya}</p></div>
                    <div class="flex gap-1">
                        <button onclick="printBill('${o.oid}')" class="text-sky-500 p-2"><i class="fas fa-print"></i></button>
                        <button onclick="delOrder('${o.oid}')" class="text-red-400 p-2"><i class="fas fa-trash"></i></button>
                    </div>
                </div>`).join('');
        }

        function delBook(idx) { if(confirm('Ø­Ø°Ù Ø§Ù„ÙƒØªØ§Ø¨ Ù…Ù† Ø§Ù„Ù…ØªØ¬Ø±ØŸ')) { inventory.splice(idx, 1); localStorage.setItem('HK_INV', JSON.stringify(inventory)); updateUI(); } }

        function openOrderModal(idx) {
            const b = inventory[idx];
            document.getElementById('selectedBookIdx').value = idx;
            document.getElementById('mBookImg').src = b.img;
            document.getElementById('mBookTitle').innerText = b.title;
            document.getElementById('mBookPrice').innerText = b.price + " Ø¯Ø¬";
            document.getElementById('orderModal').style.display = 'flex';
        }

        function closeModal() { document.getElementById('orderModal').style.display = 'none'; }

        document.getElementById('orderForm').onsubmit = e => {
            e.preventDefault();
            const b = inventory[document.getElementById('selectedBookIdx').value];
            const wSelect = document.getElementById('cWilaya');
            const wilayaText = wSelect.options[wSelect.selectedIndex].text;
            const oid = 'HK-' + Math.floor(1000 + Math.random()*8999);
            const quote = quotes[Math.floor(Math.random()*quotes.length)];
            const cName = document.getElementById('cName').value;
            const cPhone = document.getElementById('cPhone').value;

            orders.unshift({ oid, name: cName, phone: cPhone, wilaya: wilayaText, book: b.title, price: b.price, quote, date: new Date().toLocaleDateString('ar-DZ') });
            localStorage.setItem('HK_ORD', JSON.stringify(orders));

            const msg = `*Ø·Ù„Ø¨ Ø¬Ø¯ÙŠØ¯ Ù…Ù† Ø±ÙˆØ§Ù‚ ÙƒÙˆØ«Ø±* ğŸ“š%0A%0A*Ø±Ù‚Ù… Ø§Ù„Ø·Ù„Ø¨:* ${oid}%0A*Ø§Ù„Ø²Ø¨ÙˆÙ†:* ${cName}%0A*Ø§Ù„Ù‡Ø§ØªÙ:* ${cPhone}%0A*Ø§Ù„ÙˆÙ„Ø§ÙŠØ©:* ${wilayaText}%0A*Ø§Ù„ÙƒØªØ§Ø¨:* ${b.title}%0A*Ø§Ù„Ø³Ø¹Ø±:* ${b.price} Ø¯Ø¬%0A%0A*Ø­ÙƒÙ…Ø© Ø§Ù„ÙŠÙˆÙ…:* "${quote}" âœ¨`;
            window.open(`https://wa.me/${KAWTHAR_WA}?text=${msg}`, '_blank');
            closeModal(); updateUI();
        };

        function trackOrder() {
            const val = document.getElementById('trackInput').value.toUpperCase();
            const o = orders.find(x => x.oid === val);
            if(o) {
                document.getElementById('trackResult').classList.remove('hidden');
                document.getElementById('trackQuote').innerText = `Ø¨ÙˆÙ‚Ø§Ù„Ø© Ø·Ù„Ø¨Ùƒ: "${o.quote}"`;
            } else alert("Ø§Ù„Ø±Ù‚Ù… ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯");
        }

        function printBill(id) {
            const o = orders.find(x => x.oid === id);
            const area = document.getElementById('thermal-area');
            area.innerHTML = `<div style="text-align:center; padding:10px; direction:rtl;"><h3>Ø±ÙˆØ§Ù‚ ÙƒÙˆØ«Ø±</h3><p>#${o.oid}</p><hr><p>Ø§Ù„Ø²Ø¨ÙˆÙ†: ${o.name}</p><p>Ø§Ù„Ù‡Ø§ØªÙ: ${o.phone}</p><p>Ø§Ù„ÙˆÙ„Ø§ÙŠØ©: ${o.wilaya}</p><p>Ø§Ù„ÙƒØªØ§Ø¨: ${o.book}</p><h4>Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹: ${o.price} DA</h4></div>`;
            window.print();
        }

        function exportData() {
            const data = { inv: localStorage.getItem('HK_INV'), ord: localStorage.getItem('HK_ORD') };
            const blob = new Blob([JSON.stringify(data)], {type: 'application/json'});
            const a = document.createElement('a');
            a.href = URL.createObjectURL(blob);
            a.download = `HK_Backup.json`;
            a.click();
        }

        function importData() {
            const input = document.createElement('input'); input.type = 'file';
            input.onchange = e => {
                const reader = new FileReader();
                reader.onload = ev => {
                    const data = JSON.parse(ev.target.result);
                    localStorage.setItem('HK_INV', data.inv);
                    localStorage.setItem('HK_ORD', data.ord);
                    location.reload();
                };
                reader.readAsText(e.target.files[0]);
            };
            input.click();
        }

        function delOrder(id) { if(confirm('Ø­Ø°Ù Ø§Ù„Ø·Ù„Ø¨ØŸ')) { orders = orders.filter(x => x.oid !== id); localStorage.setItem('HK_ORD', JSON.stringify(orders)); updateUI(); } }
        function toggleDarkMode() { document.body.classList.toggle('dark-mode'); }
        updateUI();
    </script>
</body>
</html>
